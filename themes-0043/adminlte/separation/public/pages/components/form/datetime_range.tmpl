{{define "form_datetime_range"}}
    {{if .Editable}}
        <div class="input-group">
            {{if ne .Label ""}}
                <span class="input-group-addon">{{.Label}}</span>
            {{else}}
                {{if not .NoIcon}}
                    <span class="input-group-addon"><i class="fa fa-calendar fa-fw"></i></span>
                {{end}}
            {{end}} 
            <input type="text" id="{{.Field}}_start_key" name="{{.Field}}_start_key" value="{{.Value}}"
                   class="form-control {{.Field}}_start_key" placeholder="{{.Placeholder}}">
            <span class="input-group-addon" style="border-left: 0; border-right: 0;">-</span>
            <input type="text" id="{{.Field}}_end_key" name="{{.Field}}_end_key" value="{{.Value2}}"
                   class="form-control {{.Field}}_end_key" placeholder="{{.Placeholder}}">
        </div>
        <script>
            $(function () {
				function getParam(key){
					const p = new URLSearchParams(window.location.search);
					var ret = decodeURIComponent(p.get(key));
					if (ret=='null'){
						ret = '';
					}
					return ret;
				}
				
				var inputStart = $('#{{.Field}}_start_key');
				var inputEnd = $('#{{.Field}}_end_key');
				
                inputStart.datetimepicker({{.OptionExt}});
                {{if eq .OptionExt2 ""}}
                    inputEnd.datetimepicker({{.OptionExt}});
                {{else}}
                    inputEnd.datetimepicker({{.OptionExt2}});
                {{end}}

                inputStart.on("dp.change", function (e) {
                    inputEnd.data("DateTimePicker").minDate(e.date);
                });
                inputEnd.on("dp.change", function (e) {
                    inputStart.data("DateTimePicker").maxDate(e.date);
                });
				
				var d1 = getParam('{{.Field}}_start_key');
				var d2 = getParam('{{.Field}}_end_key');
				if(d1!='' && inputStart.val()==''){inputStart.val(d1);}
				if(d2!='' && inputEnd.val()==''){inputEnd.val(d2);}
            });
        </script>
    {{else}}
        <div class="box box-solid box-default no-margin" style="cursor:not-allowed;background-color:#eee;">
            <div class="box-body">{{.Value}}</div>
        </div>
        <input type="hidden" class="{{.Field}}" name="{{.Field}}" id="input-{{.Field}}" value='{{.Value}}'>
    {{end}}
{{end}}